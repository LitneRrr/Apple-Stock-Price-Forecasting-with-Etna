# Apple-Stock-Price-Forecasting-with-Etna
# Прогнозирование цен на акции Apple с использованием библиотеки Etna

Этот проект представляет собой комплексный анализ временного ряда цен открытия акций компании Apple (AAPL). Цель проекта — построить и сравнить различные модели для прогнозирования стоимости акций на 7 дней вперёд. В работе используются как классические статистические подходы (SARIMA, ETS), так и градиентный бустинг (CatBoost) с помощью специализированной библиотеки для анализа временных рядов `etna`.

## Этапы проекта

Проект охватывает все ключевые этапы работы с временными рядами:

1.  **Загрузка и предобработка данных**:
    *   Загрузка исторических данных о ценах акций Apple (`applestock.csv`).
    *   **Заполнение пропусков**: Для восстановления пропущенных данных (выходные и праздничные дни) использовалась импутация на основе скользящего среднего (`running_mean`).
    *   **Анализ выбросов**: Проведен анализ на наличие аномалий с использованием методов на основе медианного фильтра и плотности распределения. Было принято решение не удалять выбросы, так как они могут содержать ценную информацию о рыночных событиях.

2.  **Анализ структуры временного ряда**:
    *   **Проверка на стационарность**: С помощью теста Дики-Фуллера было установлено, что исходный ряд нестационарен.
    *   **Дифференцирование**: Для приведения ряда к стационарному виду была применена операция дифференцирования первого порядка.
    *   **Анализ автокорреляции (ACF)**: Построен график автокорреляционной функции для анализа структуры ряда.

3.  **Моделирование**:
    Для прогнозирования были построены и оценены следующие модели:
    *   **Базовые модели**:
        *   `NaiveModel`: Наивный прогноз.
        *   `MovingAverageModel`: Скользящее среднее.
        *   `SeasonalMovingAverageModel`: Сезонное скользящее среднее.
    *   **Модели экспоненциального сглаживания (ETS)**:
        *   `SimpleExpSmoothingModel`: Простое экспоненциальное сглаживание.
        *   `HoltModel` и `HoltWintersModel`: Модели Хольта и Хольта-Винтерса с подбором оптимальных параметров `alpha` и `beta` по сетке.
    *   **Статистическая модель**:
        *   `SARIMA`: Подобран оптимальный порядок модели `(p, d, q)` на основе информационного критерия Акаике (AIC).
    *   **Модель машинного обучения**:
        *   `CatBoostMultiSegmentModel`: Модель градиентного бустинга с предварительной генерацией признаков (лаговые признаки и скользящие средние).

4.  **Оценка и сравнение моделей**:
    *   Все модели прогнозировали значения на **7 дней вперёд (HORIZON = 7)**.
    *   Качество прогнозов оценивалось с помощью метрики **SMAPE** (Symmetric Mean Absolute Percentage Error).

## Результаты

Сравнение моделей по метрике SMAPE на тестовой выборке показало следующие результаты:

| Модель | SMAPE |
| :--- | :--- |
| **HoltWintersModel** | **0.694857** |
| SARIMA | 1.109520 |
| SimpleExpSmoothingModel | 1.112967 |
| HoltModel | 1.112715 |
| CatBoost | 2.115915 |
| NaiveModel | 2.578291 |
| MovingAverageModel | 1.978520 |
| SeasonalMovingAverageModel | 1.699103 |

**Вывод**: Наилучшее качество прогноза на заданном горизонте показала модель **Хольта-Винтерса** с оптимально подобранными параметрами сглаживания.

## Зависимости

Основные библиотеки, используемые в проекте:

-   `etna`
-   `pandas`
-   `statsmodels`
-   `numpy`
-   `scipy`
-   `matplotlib`
-   `catboost`